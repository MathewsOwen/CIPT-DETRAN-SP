<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>DETRAN 3D - FERRARI ROMA</title>
    <style>
        body { margin: 0; overflow: hidden; background: #87CEEB; font-family: sans-serif; }
        #status { position: fixed; bottom: 20px; width: 100%; text-align: center; color: white; background: rgba(0,0,0,0.8); padding: 10px; z-index: 100; }
    </style>
</head>
<body>
    <div id="status">Buscando arquivo: low_poly_ferrari_roma.glb...</div>

    <script type="module">
        import * as THREE from 'https://cdn.skypack.dev/three@0.136.0';
        import { GLTFLoader } from 'https://cdn.skypack.dev/three@0.136.0/examples/jsm/loaders/GLTFLoader.js';

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x87CEEB);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 5, 12);

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.outputEncoding = THREE.sRGBEncoding;
        document.body.appendChild(renderer.domElement);

        // Luzes para destacar a lataria
        scene.add(new THREE.AmbientLight(0xffffff, 1.5));
        const sun = new THREE.DirectionalLight(0xffffff, 1);
        sun.position.set(5, 10, 7);
        scene.add(sun);

        // Chão e Pista
        scene.add(new THREE.GridHelper(200, 50));
        const road = new THREE.Mesh(new THREE.PlaneGeometry(20, 2000), new THREE.MeshStandardMaterial({color: 0x222222}));
        road.rotation.x = -Math.PI / 2;
        scene.add(road);

        let car;
        const loader = new GLTFLoader();

        // USANDO O NOME EXATO DO SEU ARQUIVO
        loader.load('low_poly_ferrari_roma.glb', (gltf) => {
            car = gltf.scene;
            
            // Ajuste de escala (como é low poly, 1.5 deve ser o tamanho ideal)
            car.scale.set(1.5, 1.5, 1.5);
            
            scene.add(car);
            document.getElementById('status').innerText = "✅ FERRARI ROMA CARREGADA! Use as setas.";
        }, 
        (xhr) => {
            const p = Math.round((xhr.loaded / xhr.total) * 100);
            document.getElementById('status').innerText = "Carregando: " + p + "%";
        },
        (error) => {
            document.getElementById('status').innerText = "❌ ERRO: O arquivo 'low_poly_ferrari_roma.glb' não está no GitHub!";
        });

        const keys = {};
        window.addEventListener('keydown', e => keys[e.code] = true);
        window.addEventListener('keyup', e => keys[e.code] = false);

        function animate() {
            requestAnimationFrame(animate);
            if (car) {
                if(keys['ArrowUp']) car.translateZ(0.4); 
                if(keys['ArrowDown']) car.translateZ(-0.2);
                if(keys['ArrowLeft']) car.rotation.y += 0.05;
                if(keys['ArrowRight']) car.rotation.y -= 0.05;

                const offset = new THREE.Vector3(0, 4, -10).applyMatrix4(car.matrixWorld);
                camera.position.lerp(offset, 0.1);
                camera.lookAt(car.position);
            }
            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
