// --- ROTA RECALIBRADA (CURVA MAIS LONGA) ---
const rota = [
    { x: -114, z: 208, pausa: false }, // Início (Amarelo)
    { x: -50,  z: 208, pausa: true,  q: "Qual a cor que indica 'Pare'?", r: ["Vermelho", "Verde"], c: 0 },
    { x: 30,   z: 208, pausa: true,  q: "Devemos usar o cinto?", r: ["Sempre", "Nunca"], c: 0 },
    { x: 100,  z: 208, pausa: true,  q: "Podemos avançar o sinal vermelho?", r: ["Sim", "Não"], c: 1 },
    { x: 145,  z: 208, pausa: false }, // PONTO DA CURVA (Aumentado para ele ir mais longe)
    { x: 145,  z: 150, pausa: true,  q: "Celular ao dirigir é permitido?", r: ["Não", "Sim"], c: 0 },
    { x: 145,  z: 80,  pausa: true,  q: "O pedestre tem prioridade?", r: ["Sim", "Não"], c: 0 },
    { x: 145,  z: 20,  pausa: true,  q: "Parabéns! Fim da Prova!", r: ["Finalizar", "Reiniciar"], c: 0 }
];

// ... (No seu loader, mantenha o resto igual) ...

function animate() {
    requestAnimationFrame(animate);
    if (car && emMovimento && etapaAtual < rota.length) {
        const destino = rota[etapaAtual];
        
        // Movimentação
        const dx = destino.x - car.position.x;
        const dz = destino.z - car.position.z;
        
        car.position.x += dx * 0.05;
        car.position.z += dz * 0.05;

        // Rotação
        if (Math.abs(dx) > 0.1 || Math.abs(dz) > 0.1) {
            const anguloAlvo = Math.atan2(dx, dz);
            car.rotation.y = anguloAlvo;
        }

        // Chegou no ponto?
        if (Math.abs(dx) < 0.5 && Math.abs(dz) < 0.5) {
            if (destino.pausa) {
                emMovimento = false;
                montarPergunta();
            } else {
                etapaAtual++;
            }
        }

        // --- CÂMERA DE LADO (PERFIL) ---
        // X: -35 joga a câmera para a lateral esquerda do carro
        // Y: 10 dá um pouco de altura
        // Z: 0 mantém ela alinhada com o meio do carro
        const offset = new THREE.Vector3(-35, 10, 0).applyMatrix4(car.matrixWorld);
        camera.position.lerp(offset, 0.1);
        camera.lookAt(car.position);
    }
    // ... restando do código ...
}
