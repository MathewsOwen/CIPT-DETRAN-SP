<script type="module">
    import * as THREE from 'https://cdn.skypack.dev/three@0.136.0';
    import { GLTFLoader } from 'https://cdn.skypack.dev/three@0.136.0/examples/jsm/loaders/GLTFLoader.js';

    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x87CEEB);
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 5000);
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    scene.add(new THREE.AmbientLight(0xffffff, 2.0));
    const loader = new GLTFLoader();
    let car;

    // Carregando a cidade
    loader.load('city_-_cidade (2).glb', (gltf) => {
        scene.add(gltf.scene);
        
        loader.load('low_poly_ferrari_roma.glb', (gC) => {
            car = gC.scene; 
            car.scale.set(6, 6, 6); 
            car.position.set(0, 0.15, 0); // Come√ßa no zero para a gente achar a rua
            scene.add(car);
            console.log("USE AS SETAS PARA MOVER O CARRO E 'P' PARA VER A COORDENADA NO CONSOLE");
        });
    });

    // SISTEMA DE BUSCA DE COORDENADA (S√ì PARA A GENTE ACHAR A RUA)
    window.addEventListener('keydown', (e) => {
        if (!car) return;
        const speed = 2;
        if (e.key === "ArrowUp") car.position.z -= speed;
        if (e.key === "ArrowDown") car.position.z += speed;
        if (e.key === "ArrowLeft") car.position.x -= speed;
        if (e.key === "ArrowRight") car.position.x += speed;
        
        if (e.key === "p" || e.key === "P") {
            console.log(`üìç POSI√á√ÉO ATUAL -> X: ${car.position.x.toFixed(2)}, Z: ${car.position.z.toFixed(2)}`);
            alert(`X: ${car.position.x.toFixed(2)}, Z: ${car.position.z.toFixed(2)}`);
        }
    });

    function animate() {
        requestAnimationFrame(animate);
        if (car) {
            const offset = new THREE.Vector3(0, 40, 60); // Vis√£o de cima para ajudar a guiar
            camera.position.copy(car.position).add(offset);
            camera.lookAt(car.position);
        }
        renderer.render(scene, camera);
    }
    animate();
</script>
